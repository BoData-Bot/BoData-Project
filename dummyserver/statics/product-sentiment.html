<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <title>boData</title>
  <!-- Bootstrap core CSS-->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <!-- Custom fonts for this template-->
  <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <!-- Custom styles for this template-->
  <link href="css/sb-admin.css" rel="stylesheet">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

  <style>

      #sentiment-product {
          width: 150px;
      }

      #sentiment-location {
          width: 150px;
      }


  </style>

  <script>


  </script>




</head>

<body class="fixed-nav sticky-footer bg-dark" id="page-top">
<!-- Navigation-->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top" id="mainNav">
  <a class="navbar-brand" href="index.html">boData</a>

  <div class="collapse navbar-collapse" id="navbarResponsive">
    <ul class="navbar-nav navbar-sidenav" id="exampleAccordion">

      <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Charts">
        <a class="nav-link" href="product-mentions.html">
          <i class="fa fa-fw fa-area-chart"></i>
          <span class="nav-link-text">Product Mentions</span>
        </a>
      </li>
      <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Tables">
        <a class="nav-link" href="product-sentiment.html">
          <i class="fa fa-fw fa-table"></i>
          <span class="nav-link-text">Sentiment Analysis</span>
        </a>
      </li>

    </ul>
    <ul class="navbar-nav sidenav-toggler">
      <li class="nav-item">
        <a class="nav-link text-center" id="sidenavToggler">
          <i class="fa fa-fw fa-angle-left"></i>
        </a>
      </li>
    </ul>
    <ul class="navbar-nav ml-auto">
      <li class="nav-item">
        <a class="nav-link" data-toggle="modal" data-target="#exampleModal">
          <i class="fa fa-fw fa-sign-out"></i>Logout</a>
      </li>
    </ul>
  </div>
</nav>
<div class="content-wrapper">
  <div class="container-fluid">
    <h1>Sentiment Analysis</h1>
    <p>1. Select product and location</p>
      <p>2. Click Analyze</p>

    <div class = "row">

      <div class = "col-md-3">
          <label>Product</label>
          <br>
          <select id="sentiment-product">
              <option>ProdA</option>
              <option>ProdB</option>
              <option>ProdC</option>
          </select>
          <br><br>
          <div><input type="button" value="analyze" onclick = "test_function()"/></div>
        <!--<div class="dropdown">-->
          <!--<button class="btn btn-primary dropdown-toggle" id = "sentiment-product" type="button" data-toggle="dropdown">Product-->
          <!--<span class="caret"></span></button>-->
          <!--<ul class="dropdown-menu">-->
            <!--<li><a href="#">ProdA</a></li>-->
            <!--<li><a href="#">ProdB</a></li>-->
            <!--<li><a href="#">ProdC</a></li>-->
          <!--</ul>-->
        <!--</div>-->
      </div>
      <div class = "col-md-3">
          <label>Location</label>
          <br>
          <select id="sentiment-location">
              <option>Bangkok</option>
              <option>Kuala Lampur</option>
          </select>

          <!--<div class="dropdown">-->
          <!--<button class="btn btn-primary dropdown-toggle" id = "sentiment-location" type="button" data-toggle="dropdown">Location-->
            <!--<span class="caret"></span></button>-->
          <!--<ul class="dropdown-menu">-->
            <!--<li><a href="#">Bangkok</a></li>-->
            <!--<li><a href="#">Kuala Lampur</a></li>-->
          <!--</ul>-->
        <!--</div>-->

      </div>

    </div>
    <!-- Area Chart Example-->
    <br><br><br>

    <div class="row">

      <div class = "col-md-12" id = "graph">
        <canvas id="ProductSentiment"></canvas>
      </div>
    </div>



    <!-- Example DataTables Card-->
    <div class="card mb-3">
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
            <thead>
            <tr>
              <th>Sentence</th>
              <th>Sentiment</th>
              <th style = 'text-align: center;'>Confidence</th>

            </tr>
            </thead>
            <!--<tfoot>-->
            <!--<tr>-->
              <!--<th>Sentence</th>-->
              <!--<th>Sentiment</th>-->
              <!--<th>Confidence</th>-->
            <!--</tr>-->
            <!--</tfoot>-->
            <tbody>
            <tr>
              <td> Example: I love this soda</td>
              <td  style = 'background-color: #20c997;' > positive </td>
              <td style = 'text-align: center;'> 99 </td>
            <tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="card-footer small text-muted">Updated yesterday at 11:59 PM</div>
    </div>
  </div>

  </div>

  <!-- /.content-wrapper-->
  <footer class="sticky-footer">
    <div class="container">
      <div class="text-center">
        <small>Cornell Tech 2017</small>
      </div>
    </div>
  </footer>
  <!-- Scroll to Top Button-->
  <a class="scroll-to-top rounded" href="#page-top">
    <i class="fa fa-angle-up"></i>
  </a>
  <!-- Logout Modal-->
  <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
          <button class="close" type="button" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">Ã—</span>
          </button>
        </div>
        <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
        <div class="modal-footer">
          <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
          <a class="btn btn-primary" href="login.html">Logout</a>
        </div>
      </div>
    </div>
  </div>
  <!-- Bootstrap core JavaScript-->
  <!-- Bootstrap core JavaScript-->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <!-- Core plugin JavaScript-->
  <script src="vendor/jquery-easing/jquery.easing.min.js"></script>
  <!-- Page level plugin JavaScript-->
  <script src="vendor/chart.js/Chart.min.js"></script>
  <!-- Custom scripts for all pages-->
  <script src="js/sb-admin.min.js"></script>
  <!-- Custom scripts for this page-->
  <script src="js/sb-admin-charts.min.js"></script>

  <script>




      function test_function2(){
          // var temp = $('#sentiment-product:selected').text();
          var temp = $('#sentiment-product').find(":selected").text();
          console.log("hello", temp);
      }

      var counter_pos = 0;
      var counter_neg = 0;
      var counter_neut = 0;

      function test_function(){
           console.log("hi");
          var product = $('#sentiment-product').find(":selected").text();
          var location = $('#sentiment-location').find(":selected").text();

          $('tr').remove();

          $.post("http://localhost:5000/getsentimentfigure",
              {
                  products: "[['"+ product +"'],['" + location + "']]"
              },
              function(data, status){
                  realdata = eval(data);

                  for(var i = 0; i < realdata.length-1; i++) {

                      line = realdata[i];
                      var sentence = line[0];
                      var sentiment = line[1];
                      var confidence = line[2];
                      if (sentiment == "positive") {
                          var color = "#20c997;"
                          counter_pos = counter_pos +1;
                      } else if (sentiment == "neutral") {
                          var color = "#FFC107;"
                          counter_neut = counter_neut +1;
                      } else {
                          var color = "#dc3545;"
                          counter_neg = counter_neg +1;
                          //console.log(counter)
                      }

                      $("#dataTable").append( "<tr><td>" + sentence + "</td>" +
                          "<td style = 'background-color: " + color +"'>" + sentiment + "</td>" +
                          "<td style = 'text-align: center;'>" + confidence + "</td></tr>");


                  }

                  var ctx = document.getElementById('ProductSentiment').getContext('2d');

                  var ProductMentions = new Chart(ctx, {
                      type: 'bar',
                      options: {
                          responsive: true,
                          maintainAspectRatio: false,
                          legend: {
                              display: true
                          },
                          scales: {
                              yAxes: [{
                                  ticks: {
                                      beginAtZero: true
                                  }
                              }],
                              xAxes: [{
                                  gridLines: {
                                      display:false
                                  }
                              }]


                          }
                      },
                      data: {

                          // labels: ['Negative','Neutral','Positive'],
                          datasets: [{
                              label: 'Negative',
                              data: [counter_neg],
                              backgroundColor: "rgba(220,53,69,1)"

                          }, {
                              label: 'Neutral',
                              data: [counter_neut],
                              backgroundColor: "rgba(255,193,7,1)"

                          },{
                              label: 'Positive',
                              data: [counter_pos],
                              backgroundColor: "rgba(32,201,151,1)"

                          }
                          ]
                      }
                  });

                  //realdata = eval(data);
                  //console.log(realdata[0]);
              });
      }




      //console.log(counter);
//      var ctx = document.getElementById('ProductSentiment').getContext('2d');
//
//      var ProductMentions = new Chart(ctx, {
//          type: 'bar',
//          options: {
//              responsive: true,
//              maintainAspectRatio: false,
//              legend: {
//                  display: true
//              },
//              scales: {
//                  yAxes: [{
//                      ticks: {
//                          beginAtZero: true
//                      }
//                  }],
//                  xAxes: [{
//                      gridLines: {
//                          display:false
//                      }
//                  }]
//
//
//              }
//          },
//          data: {
//
//             // labels: ['Negative','Neutral','Positive'],
//              datasets: [{
//                  label: 'Negative',
//                  data: [12],
//                  backgroundColor: "rgba(220,53,69,1)"
//
//              }, {
//                  label: 'Neutral',
//                  data: [2],
//                  backgroundColor: "rgba(134,142,150,1)"
//
//              },{
//                  label: 'Positive',
//                  data: [1],
//                  backgroundColor: "rgba(40,167,69,1)"
//
//              }
//              ]
//          }
//      });


  </script>


</div>
</body>

</html>
